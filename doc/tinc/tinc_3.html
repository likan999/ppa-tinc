<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on December, 26 2008 by texi2html 1.78 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>

-->
<head>
<title>tinc Manual: 4. Configuration</title>

<meta name="description" content="tinc Manual: 4. Configuration">
<meta name="keywords" content="tinc Manual: 4. Configuration">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.78">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.roman {font-family:serif; font-weight:normal;}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="Configuration"></a>
<a name="SEC29"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="tinc_2.html#SEC26" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC30" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_2.html#SEC19" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1 class="chapter"> 4. Configuration </h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#SEC30">4.1 Configuration introduction</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC31">4.2 Multiple networks</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC32">4.3 How connections work</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC33">4.4 Configuration files</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC40">4.5 Generating keypairs</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC41">4.6 Network interfaces</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC42">4.7 Example configuration</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Configuration-introduction"></a>
<a name="SEC30"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC29" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC31" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC29" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 4.1 Configuration introduction </h2>

<p>Before actually starting to configure tinc and editing files,
make sure you have read this entire section so you know what to expect.
Then, make it clear to yourself how you want to organize your VPN:
What are the nodes (computers running tinc)?
What IP addresses/subnets do they have?
What is the network mask of the entire VPN?
Do you need special firewall rules?
Do you have to set up masquerading or forwarding rules?
Do you want to run tinc in router mode or switch mode?
These questions can only be answered by yourself,
you will not find the answers in this documentation.
Make sure you have an adequate understanding of networks in general.
A good resource on networking is the
<a href="http://www.linuxdoc.org/LDP/nag2/">Linux Network Administrators Guide</a>.
</p>
<p>If you have everything clearly pictured in your mind,
proceed in the following order:
First, generate the configuration files (&lsquo;<tt>tinc.conf</tt>&rsquo;, your host configuration file, &lsquo;<tt>tinc-up</tt>&rsquo; and perhaps &lsquo;<tt>tinc-down</tt>&rsquo;).
Then generate the keypairs.
Finally, distribute the host configuration files.
These steps are described in the subsections below.
</p>

<hr size="6">
<a name="Multiple-networks"></a>
<a name="SEC31"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC30" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC32" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC29" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 4.2 Multiple networks </h2>

<a name="IDX9"></a>
<p>In order to allow you to run more than one tinc daemon on one computer,
for instance if your computer is part of more than one VPN,
you can assign a <var>netname</var> to your VPN.
It is not required if you only run one tinc daemon,
it doesn't even have to be the same on all the sites of your VPN,
but it is recommended that you choose one anyway.
</p>
<p>We will asume you use a netname throughout this document.
This means that you call tincd with the -n argument,
which will assign a netname to this daemon.
</p>
<p>The effect of this is that the daemon will set its configuration
root to &lsquo;<tt>/etc/tinc/<var>netname</var>/</tt>&rsquo;, where <var>netname</var> is your argument to the -n
option.  You'll notice that it appears in syslog as &lsquo;<tt>tinc.<var>netname</var></tt>&rsquo;.
</p>
<p>However, it is not strictly necessary that you call tinc with the -n
option.  In this case, the network name would just be empty, and it will
be used as such.  tinc now looks for files in &lsquo;<tt>/etc/tinc/</tt>&rsquo;, instead of
&lsquo;<tt>/etc/tinc/<var>netname</var>/</tt>&rsquo;; the configuration file should be &lsquo;<tt>/etc/tinc/tinc.conf</tt>&rsquo;,
and the host configuration files are now expected to be in &lsquo;<tt>/etc/tinc/hosts/</tt>&rsquo;.
</p>
<p>But it is highly recommended that you use this feature of tinc, because
it will be so much clearer whom your daemon talks to.  Hence, we will
assume that you use it.
</p>

<hr size="6">
<a name="How-connections-work"></a>
<a name="SEC32"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC31" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC33" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC29" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 4.3 How connections work </h2>

<p>When tinc starts up, it parses the command-line options and then
reads in the configuration file tinc.conf.
If it sees one or more  `ConnectTo' values pointing to other tinc daemons in that file,
it will try to connect to those other daemons.
Whether this succeeds or not and whether `ConnectTo' is specified or not,
tinc will listen for incoming connection from other deamons.
If you did specify a `ConnectTo' value and the other side is not responding,
tinc will keep retrying.
This means that once started, tinc will stay running until you tell it to stop,
and failures to connect to other tinc daemons will not stop your tinc daemon
for trying again later.
This means you don't have to intervene if there are temporary network problems.
</p>
<a name="IDX10"></a>
<a name="IDX11"></a>
<p>There is no real distinction between a server and a client in tinc.
If you wish, you can view a tinc daemon without a `ConnectTo' value as a server,
and one which does specify such a value as a client.
It does not matter if two tinc daemons have a `ConnectTo' value pointing to each other however.
</p>

<hr size="6">
<a name="Configuration-files"></a>
<a name="SEC33"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC32" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC34" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC29" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 4.4 Configuration files </h2>

<p>The actual configuration of the daemon is done in the file
&lsquo;<tt>/etc/tinc/<var>netname</var>/tinc.conf</tt>&rsquo; and at least one other file in the directory
&lsquo;<tt>/etc/tinc/<var>netname</var>/hosts/</tt>&rsquo;.
</p>
<p>These file consists of comments (lines started with a #) or assignments
in the form of
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Variable = Value.
</pre></td></tr></table>

<p>The variable names are case insensitive, and any spaces, tabs, newlines
and carriage returns are ignored.  Note: it is not required that you put
in the `=' sign, but doing so improves readability.  If you leave it
out, remember to replace it with at least one space character.
</p>
<p>In this section all valid variables are listed in alphabetical order.
The default value is given between parentheses,
other comments are between square brackets.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#SEC34">4.4.1 Main configuration variables</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC35">4.4.2 Host configuration variables</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC36">4.4.3 Scripts</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC37">4.4.4 How to configure</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr size="6">
<a name="Main-configuration-variables"></a>
<a name="SEC34"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC33" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC35" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC33" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection"> 4.4.1 Main configuration variables </h3>

<dl compact="compact">
<dd><a name="IDX12"></a>
</dd>
<dt> AddressFamily = &lt;ipv4|ipv6|any&gt; (any)</dt>
<dd><p>This option affects the address family of listening and outgoing sockets.
If any is selected, then depending on the operating system
both IPv4 and IPv6 or just IPv6 listening sockets will be created.
</p>
<a name="IDX13"></a>
</dd>
<dt> BindToAddress = &lt;<var>address</var>&gt; [experimental]</dt>
<dd><p>If your computer has more than one IPv4 or IPv6 address, tinc
will by default listen on all of them for incoming connections.
It is possible to bind only to a single address with this variable.
</p>
<p>This option may not work on all platforms.
</p>
<a name="IDX14"></a>
</dd>
<dt> BindToInterface = &lt;<var>interface</var>&gt; [experimental]</dt>
<dd><p>If you have more than one network interface in your computer, tinc will
by default listen on all of them for incoming connections.  It is
possible to bind tinc to a single interface like eth0 or ppp0 with this
variable.
</p>
<p>This option may not work on all platforms.
</p>
<a name="IDX15"></a>
</dd>
<dt> ConnectTo = &lt;<var>name</var>&gt;</dt>
<dd><p>Specifies which other tinc daemon to connect to on startup.
Multiple ConnectTo variables may be specified,
in which case outgoing connections to each specified tinc daemon are made.
The names should be known to this tinc daemon
(i.e., there should be a host configuration file for the name on the ConnectTo line).
</p>
<p>If you don't specify a host with ConnectTo,
tinc won't try to connect to other daemons at all,
and will instead just listen for incoming connections.
</p>
<a name="IDX16"></a>
</dd>
<dt> Device = &lt;<var>device</var>&gt; (&lsquo;<tt>/dev/tap0</tt>&rsquo;, &lsquo;<tt>/dev/net/tun</tt>&rsquo; or other depending on platform)</dt>
<dd><p>The virtual network device to use.
Tinc will automatically detect what kind of device it is.
Note that you can only use one device per daemon.
Under Windows, use <var>Interface</var> instead of <var>Device</var>.
Note that you can only use one device per daemon.
See also <a href="tinc_2.html#SEC25">Device files</a>.
</p>
<a name="IDX17"></a>
</dd>
<dt> DeviceType = &lt;tun|tunnohead|tunifhead|tap&gt; (only supported on BSD platforms)</dt>
<dd><p>The type of the virtual network device.
Tinc will normally automatically select the right type, and this option should not be used.
However, in case tinc does not seem to correctly interpret packets received from the virtual network device,
using this option might help.
</p>
<dl compact="compact">
<dt> tun</dt>
<dd><p>Set type to tun.
Depending on the platform, this can either be with or without an address family header (see below).
</p>
<a name="IDX18"></a>
</dd>
<dt> tunnohead</dt>
<dd><p>Set type to tun without an address family header.
Tinc will expect packets read from the virtual network device to start with an IP header.
On some platforms IPv6 packets cannot be read from or written to the device in this mode.
</p>
<a name="IDX19"></a>
</dd>
<dt> tunifhead</dt>
<dd><p>Set type to tun with an address family header.
Tinc will expect packets read from the virtual network device
to start with a four byte header containing the address family,
followed by an IP header.
This mode should support both IPv4 and IPv6 packets.
</p>
</dd>
<dt> tap</dt>
<dd><p>Set type to tap.
Tinc will expect packets read from the virtual network device
to start with an Ethernet header.
</p></dd>
</dl>

<a name="IDX20"></a>
</dd>
<dt> GraphDumpFile = &lt;<var>filename</var>&gt; [experimental]</dt>
<dd><p>If this option is present,
tinc will dump the current network graph to the file <var>filename</var>
every minute, unless there were no changes to the graph.
The file is in a format that can be read by graphviz tools.
If <var>filename</var> starts with a pipe symbol |,
then the rest of the filename is interpreted as a shell command
that is executed, the graph is then sent to stdin.
</p>
<a name="IDX21"></a>
</dd>
<dt> Hostnames = &lt;yes|no&gt; (no)</dt>
<dd><p>This option selects whether IP addresses (both real and on the VPN)
should be resolved.  Since DNS lookups are blocking, it might affect
tinc's efficiency, even stopping the daemon for a few seconds everytime
it does a lookup if your DNS server is not responding.
</p>
<p>This does not affect resolving hostnames to IP addresses from the
configuration file.
</p>
<a name="IDX22"></a>
</dd>
<dt> Interface = &lt;<var>interface</var>&gt;</dt>
<dd><p>Defines the name of the interface corresponding to the virtual network device.
Depending on the operating system and the type of device this may or may not actually set the name of the interface.
Under Windows, this variable is used to select which network interface will be used.
If you specified a Device, this variable is almost always already correctly set.
</p>
<a name="IDX23"></a>
</dd>
<dt> Mode = &lt;router|switch|hub&gt; (router)</dt>
<dd><p>This option selects the way packets are routed to other daemons.
</p>
<dl compact="compact">
<dd><a name="IDX24"></a>
</dd>
<dt> router</dt>
<dd><p>In this mode Subnet
variables in the host configuration files will be used to form a routing table.
Only unicast packets of routable protocols (IPv4 and IPv6) are supported in this mode.
</p>
<p>This is the default mode, and unless you really know you need another mode, don't change it.
</p>
<a name="IDX25"></a>
</dd>
<dt> switch</dt>
<dd><p>In this mode the MAC addresses of the packets on the VPN will be used to
dynamically create a routing table just like an Ethernet switch does.
Unicast, multicast and broadcast packets of every protocol that runs over Ethernet are supported in this mode
at the cost of frequent broadcast ARP requests and routing table updates.
</p>
<p>This mode is primarily useful if you want to bridge Ethernet segments.
</p>
<a name="IDX26"></a>
</dd>
<dt> hub</dt>
<dd><p>This mode is almost the same as the switch mode, but instead
every packet will be broadcast to the other daemons
while no routing table is managed.
</p></dd>
</dl>

<a name="IDX27"></a>
</dd>
<dt> KeyExpire = &lt;<var>seconds</var>&gt; (3600)</dt>
<dd><p>This option controls the time the encryption keys used to encrypt the data
are valid.  It is common practice to change keys at regular intervals to
make it even harder for crackers, even though it is thought to be nearly
impossible to crack a single key.
</p>
<a name="IDX28"></a>
</dd>
<dt> MACExpire = &lt;<var>seconds</var>&gt; (600)</dt>
<dd><p>This option controls the amount of time MAC addresses are kept before they are removed.
This only has effect when Mode is set to &quot;switch&quot;.
</p>
<a name="IDX29"></a>
</dd>
<dt> Name = &lt;<var>name</var>&gt; [required]</dt>
<dd><p>This is a symbolic name for this connection.
The name should consist only of alfanumeric and underscore characters (a-z, A-Z, 0-9 and _).
</p>
<a name="IDX30"></a>
</dd>
<dt> PingInterval = &lt;<var>seconds</var>&gt; (60)</dt>
<dd><p>The number of seconds of inactivity that tinc will wait before sending a
probe to the other end.
</p>
<a name="IDX31"></a>
</dd>
<dt> PingTimeout = &lt;<var>seconds</var>&gt; (5)</dt>
<dd><p>The number of seconds to wait for a response to pings or to allow meta
connections to block. If the other end doesn't respond within this time,
the connection is terminated, and the others will be notified of this.
</p>
<a name="IDX32"></a>
</dd>
<dt> PriorityInheritance = &lt;yes|no&gt; (no) [experimental]</dt>
<dd><p>When this option is enabled the value of the TOS field of tunneled IPv4 packets
will be inherited by the UDP packets that are sent out.
</p>
<a name="IDX33"></a>
</dd>
<dt> PrivateKey = &lt;<var>key</var>&gt; [obsolete]</dt>
<dd><p>This is the RSA private key for tinc. However, for safety reasons it is
advised to store private keys of any kind in separate files. This prevents
accidental eavesdropping if you are editting the configuration file.
</p>
<a name="IDX34"></a>
</dd>
<dt> PrivateKeyFile = &lt;<var>path</var>&gt; (&lsquo;<tt>/etc/tinc/<var>netname</var>/rsa_key.priv</tt>&rsquo;)</dt>
<dd><p>This is the full path name of the RSA private key file that was
generated by &lsquo;<samp>tincd --generate-keys</samp>&rsquo;.  It must be a full path, not a
relative directory.
</p>
<p>Note that there must be exactly one of PrivateKey
or PrivateKeyFile
specified in the configuration file.
</p>
<a name="IDX35"></a>
</dd>
<dt> TunnelServer = &lt;yes|no&gt; (no) [experimental]</dt>
<dd><p>When this option is enabled tinc will no longer forward information between other tinc daemons,
and will only allow nodes and subnets on the VPN which are present in the
&lsquo;<tt>/etc/tinc/<var>netname</var>/hosts/</tt>&rsquo; directory.
</p>
</dd>
</dl>


<hr size="6">
<a name="Host-configuration-variables"></a>
<a name="SEC35"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC34" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC36" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC33" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection"> 4.4.2 Host configuration variables </h3>

<dl compact="compact">
<dd><a name="IDX36"></a>
</dd>
<dt> Address = &lt;<var>IP address</var>|<var>hostname</var>&gt; [recommended]</dt>
<dd><p>This variable is only required if you want to connect to this host.  It
must resolve to the external IP address where the host can be reached,
not the one that is internal to the VPN.
</p>
<a name="IDX37"></a>
</dd>
<dt> Cipher = &lt;<var>cipher</var>&gt; (blowfish)</dt>
<dd><p>The symmetric cipher algorithm used to encrypt UDP packets.
Any cipher supported by OpenSSL is recognized.
Furthermore, specifying &quot;none&quot; will turn off packet encryption.
It is best to use only those ciphers which support CBC mode.
</p>
<a name="IDX38"></a>
</dd>
<dt> Compression = &lt;<var>level</var>&gt; (0)</dt>
<dd><p>This option sets the level of compression used for UDP packets.
Possible values are 0 (off), 1 (fast zlib) and any integer up to 9 (best zlib),
10 (fast lzo) and 11 (best lzo).
</p>
<a name="IDX39"></a>
</dd>
<dt> Digest = &lt;<var>digest</var>&gt; (sha1)</dt>
<dd><p>The digest algorithm used to authenticate UDP packets.
Any digest supported by OpenSSL is recognized.
Furthermore, specifying &quot;none&quot; will turn off packet authentication.
</p>
<a name="IDX40"></a>
</dd>
<dt> IndirectData = &lt;yes|no&gt; (no)</dt>
<dd><p>This option specifies whether other tinc daemons besides the one you
specified with ConnectTo can make a direct connection to you.  This is
especially useful if you are behind a firewall and it is impossible to
make a connection from the outside to your tinc daemon.  Otherwise, it
is best to leave this option out or set it to no.
</p>
<a name="IDX41"></a>
</dd>
<dt> MACLength = &lt;<var>bytes</var>&gt; (4)</dt>
<dd><p>The length of the message authentication code used to authenticate UDP packets.
Can be anything from 0
up to the length of the digest produced by the digest algorithm.
</p>
<a name="IDX42"></a>
</dd>
<dt> PMTU = &lt;<var>mtu</var>&gt; (1514)</dt>
<dd><p>This option controls the initial path MTU to this node.
</p>
<a name="IDX43"></a>
</dd>
<dt> PMTUDiscovery = &lt;yes|no&gt; (yes)</dt>
<dd><p>When this option is enabled, tinc will try to discover the path MTU to this node.
After the path MTU has been discovered, it will be enforced on the VPN.
</p>
<a name="IDX44"></a>
</dd>
<dt> Port = &lt;<var>port</var>&gt; (655)</dt>
<dd><p>This is the port this tinc daemon listens on.
You can use decimal portnumbers or symbolic names (as listed in &lsquo;<tt>/etc/services</tt>&rsquo;).
</p>
<a name="IDX45"></a>
</dd>
<dt> PublicKey = &lt;<var>key</var>&gt; [obsolete]</dt>
<dd><p>This is the RSA public key for this host.
</p>
<a name="IDX46"></a>
</dd>
<dt> PublicKeyFile = &lt;<var>path</var>&gt; [obsolete]</dt>
<dd><p>This is the full path name of the RSA public key file that was generated
by &lsquo;<samp>tincd --generate-keys</samp>&rsquo;.  It must be a full path, not a relative
directory.
</p>
<a name="IDX47"></a>
<p>From version 1.0pre4 on tinc will store the public key directly into the
host configuration file in PEM format, the above two options then are not
necessary. Either the PEM format is used, or exactly
<strong>one of the above two options</strong> must be specified
in each host configuration file, if you want to be able to establish a
connection with that host.
</p>
<a name="IDX48"></a>
</dd>
<dt> Subnet = &lt;<var>address</var>[/<var>prefixlength</var>]&gt;</dt>
<dd><p>The subnet which this tinc daemon will serve.
Tinc tries to look up which other daemon it should send a packet to by searching the appropiate subnet.
If the packet matches a subnet,
it will be sent to the daemon who has this subnet in his host configuration file.
Multiple subnet lines can be specified for each daemon.
</p>
<p>Subnets can either be single MAC, IPv4 or IPv6 addresses,
in which case a subnet consisting of only that single address is assumed,
or they can be a IPv4 or IPv6 network address with a prefixlength.
Shorthand notations are not supported.
For example, IPv4 subnets must be in a form like 192.168.1.0/24,
where 192.168.1.0 is the network address and 24 is the number of bits set in the netmask.
Note that subnets like 192.168.1.1/24 are invalid!
Read a networking HOWTO/FAQ/guide if you don't understand this.
IPv6 subnets are notated like fec0:0:0:1:0:0:0:0/64.
MAC addresses are notated like 0:1a:2b:3c:4d:5e.
</p>
<a name="IDX49"></a>
<p>Prefixlength is the number of bits set to 1 in the netmask part; for
example: netmask 255.255.255.0 would become /24, 255.255.252.0 becomes
/22. This conforms to standard CIDR notation as described in
<a href="ftp://ftp.isi.edu/in-notes/rfc1519.txt">RFC1519</a>
</p>
</dd>
<dt> TCPonly = &lt;yes|no&gt; (no)</dt>
<dd><p>If this variable is set to yes, then the packets are tunnelled over a
TCP connection instead of a UDP connection.  This is especially useful
for those who want to run a tinc daemon from behind a masquerading
firewall, or if UDP packet routing is disabled somehow.
Setting this options also implicitly sets IndirectData.
</p></dd>
</dl>


<hr size="6">
<a name="Scripts"></a>
<a name="SEC36"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC35" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC37" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC33" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection"> 4.4.3 Scripts </h3>

<a name="IDX50"></a>
<p>Apart from reading the server and host configuration files,
tinc can also run scripts at certain moments.
Under Windows (not Cygwin), the scripts should have the extension .bat.
</p>
<dl compact="compact">
<dd><a name="IDX51"></a>
</dd>
<dt> &lsquo;<tt>/etc/tinc/<var>netname</var>/tinc-up</tt>&rsquo;</dt>
<dd><p>This is the most important script.
If it is present it will be executed right after the tinc daemon has been
started and has connected to the virtual network device.
It should be used to set up the corresponding network interface,
but can also be used to start other things.
Under Windows you can use the Network Connections control panel instead of creating this script.
</p>
<a name="IDX52"></a>
</dd>
<dt> &lsquo;<tt>/etc/tinc/<var>netname</var>/tinc-down</tt>&rsquo;</dt>
<dd><p>This script is started right before the tinc daemon quits.
</p>
</dd>
<dt> &lsquo;<tt>/etc/tinc/<var>netname</var>/hosts/<var>host</var>-up</tt>&rsquo;</dt>
<dd><p>This script is started when the tinc daemon with name <var>host</var> becomes reachable.
</p>
</dd>
<dt> &lsquo;<tt>/etc/tinc/<var>netname</var>/hosts/<var>host</var>-down</tt>&rsquo;</dt>
<dd><p>This script is started when the tinc daemon with name <var>host</var> becomes unreachable.
</p>
</dd>
<dt> &lsquo;<tt>/etc/tinc/<var>netname</var>/host-up</tt>&rsquo;</dt>
<dd><p>This script is started when any host becomes reachable.
</p>
</dd>
<dt> &lsquo;<tt>/etc/tinc/<var>netname</var>/host-down</tt>&rsquo;</dt>
<dd><p>This script is started when any host becomes unreachable.
</p>
</dd>
<dt> &lsquo;<tt>/etc/tinc/<var>netname</var>/subnet-up</tt>&rsquo;</dt>
<dd><p>This script is started when a Subnet becomes reachable.
The Subnet and the node it belongs to are passed in environment variables.
</p>
</dd>
<dt> &lsquo;<tt>/etc/tinc/<var>netname</var>/subnet-down</tt>&rsquo;</dt>
<dd><p>This script is started when a Subnet becomes unreachable.
</p></dd>
</dl>

<a name="IDX53"></a>
<p>The scripts are started without command line arguments,
but can make use of certain environment variables.
Under UNIX like operating systems the names of environment variables must be preceded by a $ in scripts.
Under Windows, in &lsquo;<tt>.bat</tt>&rsquo; files, they have to be put between % signs.
</p>
<dl compact="compact">
<dd><a name="IDX54"></a>
</dd>
<dt> <code>NETNAME</code></dt>
<dd><p>If a netname was specified, this environment variable contains it.
</p>
<a name="IDX55"></a>
</dd>
<dt> <code>NAME</code></dt>
<dd><p>Contains the name of this tinc daemon.
</p>
<a name="IDX56"></a>
</dd>
<dt> <code>DEVICE</code></dt>
<dd><p>Contains the name of the virtual network device that tinc uses.
</p>
<a name="IDX57"></a>
</dd>
<dt> <code>INTERFACE</code></dt>
<dd><p>Contains the name of the virtual network interface that tinc uses.
This should be used for commands like ifconfig.
</p>
<a name="IDX58"></a>
</dd>
<dt> <code>NODE</code></dt>
<dd><p>When a host becomes (un)reachable, this is set to its name.
If a subnet becomes (un)reachable, this is set to the owner of that subnet.
</p>
<a name="IDX59"></a>
</dd>
<dt> <code>REMOTEADDRESS</code></dt>
<dd><p>When a host becomes (un)reachable, this is set to its real address.
</p>
<a name="IDX60"></a>
</dd>
<dt> <code>REMOTEPORT</code></dt>
<dd><p>When a host becomes (un)reachable,
this is set to the port number it uses for communication with other tinc daemons.
</p>
</dd>
<dt> <code>SUBNET</code></dt>
<dd><p>When a subnet becomes (un)reachable, this is set to the subnet.
</p>
</dd>
</dl>


<hr size="6">
<a name="How-to-configure"></a>
<a name="SEC37"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC36" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC40" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC33" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection"> 4.4.4 How to configure </h3>

<a name="SEC38"></a>
<h4 class="subsubheading"> Step 1. Creating the main configuration file </h4>

<p>The main configuration file will be called &lsquo;<tt>/etc/tinc/<var>netname</var>/tinc.conf</tt>&rsquo;.
Adapt the following example to create a basic configuration file:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Name = <var>yourname</var>
Device = &lsquo;<tt>/dev/tap0</tt>&rsquo;
</pre></td></tr></table>

<p>Then, if you know to which other tinc daemon(s) yours is going to connect,
add `ConnectTo' values.
</p>
<a name="SEC39"></a>
<h4 class="subsubheading"> Step 2. Creating your host configuration file </h4>

<p>If you added a line containing `Name = yourname' in the main configuarion file,
you will need to create a host configuration file &lsquo;<tt>/etc/tinc/<var>netname</var>/hosts/yourname</tt>&rsquo;.
Adapt the following example to create a host configuration file:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Address = your.real.hostname.org
Subnet = 192.168.1.0/24
</pre></td></tr></table>

<p>You can also use an IP address instead of a hostname.
The `Subnet' specifies the address range that is local for <em>your part of the VPN only</em>.
If you have multiple address ranges you can specify more than one `Subnet'.
You might also need to add a `Port' if you want your tinc daemon to run on a different port number than the default (655).
</p>

<hr size="6">
<a name="Generating-keypairs"></a>
<a name="SEC40"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC37" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC41" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC29" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 4.5 Generating keypairs </h2>

<a name="IDX61"></a>
<p>Now that you have already created the main configuration file and your host configuration file,
you can easily create a public/private keypair by entering the following command:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">tincd -n <var>netname</var> -K
</pre></td></tr></table>

<p>Tinc will generate a public and a private key and ask you where to put them.
Just press enter to accept the defaults.
</p>

<hr size="6">
<a name="Network-interfaces"></a>
<a name="SEC41"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC40" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC42" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC29" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 4.6 Network interfaces </h2>

<p>Before tinc can start transmitting data over the tunnel, it must
set up the virtual network interface.
</p>
<p>First, decide which IP addresses you want to have associated with these
devices, and what network mask they must have.
</p>
<p>Tinc will open a virtual network device (&lsquo;<tt>/dev/tun</tt>&rsquo;, &lsquo;<tt>/dev/tap0</tt>&rsquo; or similar),
which will also create a network interface called something like &lsquo;<samp>tun0</samp>&rsquo;, &lsquo;<samp>tap0</samp>&rsquo;.
If you are using the Linux tun/tap driver, the network interface will by default have the same name as the <var>netname</var>.
Under Windows you can change the name of the network interface from the Network Connections control panel.
</p>
<a name="IDX62"></a>
<p>You can configure the network interface by putting ordinary ifconfig, route, and other commands
to a script named &lsquo;<tt>/etc/tinc/<var>netname</var>/tinc-up</tt>&rsquo;.
When tinc starts, this script will be executed. When tinc exits, it will execute the script named
&lsquo;<tt>/etc/tinc/<var>netname</var>/tinc-down</tt>&rsquo;, but normally you don't need to create that script.
</p>
<p>An example &lsquo;<tt>tinc-up</tt>&rsquo; script:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">#!/bin/sh
ifconfig $INTERFACE 192.168.1.1 netmask 255.255.0.0
</pre></td></tr></table>

<p>This script gives the interface an IP address and a netmask.
The kernel will also automatically add a route to this interface, so normally you don't need
to add route commands to the &lsquo;<tt>tinc-up</tt>&rsquo; script.
The kernel will also bring the interface up after this command.
The netmask is the mask of the <em>entire</em> VPN network, not just your
own subnet.
</p>
<p>The exact syntax of the ifconfig and route commands differs from platform to platform.
You can look up the commands for setting addresses and adding routes in <a href="tinc_6.html#SEC65">Platform specific information</a>,
but it is best to consult the manpages of those utilities on your platform.
</p>

<hr size="6">
<a name="Example-configuration"></a>
<a name="SEC42"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC41" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC29" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 4.7 Example configuration </h2>


<a name="IDX63"></a>
<p>Imagine the following situation.  Branch A of our example `company' wants to connect
three branch offices in B, C and D using the Internet.  All four offices
have a 24/7 connection to the Internet.
</p>
<p>A is going to serve as the center of the network.  B and C will connect
to A, and D will connect to C.  Each office will be assigned their own IP
network, 10.x.0.0.
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">A: net 10.1.0.0 mask 255.255.0.0 gateway 10.1.54.1 internet IP 1.2.3.4
B: net 10.2.0.0 mask 255.255.0.0 gateway 10.2.1.12 internet IP 2.3.4.5
C: net 10.3.0.0 mask 255.255.0.0 gateway 10.3.69.254 internet IP 3.4.5.6
D: net 10.4.0.0 mask 255.255.0.0 gateway 10.4.3.32 internet IP 4.5.6.7
</pre></td></tr></table>

<p>Here, &ldquo;gateway&rdquo; is the VPN IP address of the machine that is running the
tincd, and &ldquo;internet IP&rdquo; is the IP address of the firewall, which does not
need to run tincd, but it must do a port forwarding of TCP and UDP on port
655 (unless otherwise configured).
</p>
<p>In this example, it is assumed that eth0 is the interface that points to
the inner (physical) LAN of the office, although this could also be the
same as the interface that leads to the Internet.  The configuration of
the real interface is also shown as a comment, to give you an idea of
how these example host is set up. All branches use the netname `company'
for this particular VPN.
</p>
<a name="SEC43"></a>
<h4 class="subsubheading"> For Branch A </h4>

<p><em>BranchA</em> would be configured like this:
</p>
<p>In &lsquo;<tt>/etc/tinc/company/tinc-up</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"># Real interface of internal network:
# ifconfig eth0 10.1.54.1 netmask 255.255.0.0

ifconfig $INTERFACE 10.1.54.1 netmask 255.0.0.0
</pre></td></tr></table>

<p>and in &lsquo;<tt>/etc/tinc/company/tinc.conf</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Name = BranchA
Device = /dev/tap0
</pre></td></tr></table>

<p>On all hosts, &lsquo;<tt>/etc/tinc/company/hosts/BranchA</tt>&rsquo; contains:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Subnet = 10.1.0.0/16
Address = 1.2.3.4

-----BEGIN RSA PUBLIC KEY-----
...
-----END RSA PUBLIC KEY-----
</pre></td></tr></table>

<p>Note that the IP addresses of eth0 and tap0 are the same.
This is quite possible, if you make sure that the netmasks of the interfaces are different.
It is in fact recommended to give give both real internal network interfaces and tap interfaces the same IP address,
since that will make things a lot easier to remember and set up.
</p>

<a name="SEC44"></a>
<h4 class="subsubheading"> For Branch B </h4>

<p>In &lsquo;<tt>/etc/tinc/company/tinc-up</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"># Real interface of internal network:
# ifconfig eth0 10.2.43.8 netmask 255.255.0.0

ifconfig $INTERFACE 10.2.1.12 netmask 255.0.0.0
</pre></td></tr></table>

<p>and in &lsquo;<tt>/etc/tinc/company/tinc.conf</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Name = BranchB
ConnectTo = BranchA
</pre></td></tr></table>

<p>Note here that the internal address (on eth0) doesn't have to be the
same as on the tap0 device.  Also, ConnectTo is given so that no-one can
connect to this node.
</p>
<p>On all hosts, in &lsquo;<tt>/etc/tinc/company/hosts/BranchB</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Subnet = 10.2.0.0/16
Address = 2.3.4.5

-----BEGIN RSA PUBLIC KEY-----
...
-----END RSA PUBLIC KEY-----
</pre></td></tr></table>


<a name="SEC45"></a>
<h4 class="subsubheading"> For Branch C </h4>

<p>In &lsquo;<tt>/etc/tinc/company/tinc-up</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"># Real interface of internal network:
# ifconfig eth0 10.3.69.254 netmask 255.255.0.0

ifconfig $INTERFACE 10.3.69.254 netmask 255.0.0.0
</pre></td></tr></table>

<p>and in &lsquo;<tt>/etc/tinc/company/tinc.conf</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Name = BranchC
ConnectTo = BranchA
Device = /dev/tap1
</pre></td></tr></table>

<p>C already has another daemon that runs on port 655, so they have to
reserve another port for tinc. It knows the portnumber it has to listen on
from it's own host configuration file.
</p>
<p>On all hosts, in &lsquo;<tt>/etc/tinc/company/hosts/BranchC</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Address = 3.4.5.6
Subnet = 10.3.0.0/16
Port = 2000

-----BEGIN RSA PUBLIC KEY-----
...
-----END RSA PUBLIC KEY-----
</pre></td></tr></table>


<a name="SEC46"></a>
<h4 class="subsubheading"> For Branch D </h4>

<p>In &lsquo;<tt>/etc/tinc/company/tinc-up</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example"># Real interface of internal network:
# ifconfig eth0 10.4.3.32 netmask 255.255.0.0

ifconfig $INTERFACE 10.4.3.32 netmask 255.0.0.0
</pre></td></tr></table>

<p>and in &lsquo;<tt>/etc/tinc/company/tinc.conf</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Name = BranchD
ConnectTo = BranchC
Device = /dev/net/tun
</pre></td></tr></table>

<p>D will be connecting to C, which has a tincd running for this network on
port 2000. It knows the port number from the host configuration file.
Also note that since D uses the tun/tap driver, the network interface
will not be called `tun' or `tap0' or something like that, but will
have the same name as netname.
</p>
<p>On all hosts, in &lsquo;<tt>/etc/tinc/company/hosts/BranchD</tt>&rsquo;:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">Subnet = 10.4.0.0/16
Address = 4.5.6.7

-----BEGIN RSA PUBLIC KEY-----
...
-----END RSA PUBLIC KEY-----
</pre></td></tr></table>

<a name="SEC47"></a>
<h4 class="subsubheading"> Key files </h4>

<p>A, B, C and D all have generated a public/private keypair with the following command:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">tincd -n company -K
</pre></td></tr></table>

<p>The private key is stored in &lsquo;<tt>/etc/tinc/company/rsa_key.priv</tt>&rsquo;,
the public key is put into the host configuration file in the &lsquo;<tt>/etc/tinc/company/hosts/</tt>&rsquo; directory.
During key generation, tinc automatically guesses the right filenames based on the -n option and
the Name directive in the &lsquo;<tt>tinc.conf</tt>&rsquo; file (if it is available).
</p>
<a name="SEC48"></a>
<h4 class="subsubheading"> Starting </h4>

<p>After each branch has finished configuration and they have distributed
the host configuration files amongst them, they can start their tinc daemons.
They don't necessarily have to wait for the other branches to have started
their daemons, tinc will try connecting until they are available.
</p>

<hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC29" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="tinc_4.html#SEC49" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="tinc_0.html#SEC1" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="tinc_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="tinc_8.html#SEC71" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="tinc_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>Guus Sliepen</em> on <em>December, 26 2008</em> using <a href="http://www.nongnu.org/texi2html/"><em>texi2html 1.78</em></a>.
 </font>
 <br>

</p>
</body>
</html>
